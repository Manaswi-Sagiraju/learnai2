<!DOCTYPE html>
<html>
<head>
    <title>Quiz Page</title>
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <h1>Quiz</h1>
    <h2 id="topic-name"></h2>
    <form id="quiz-form">
        <div>
            <label>Question 1: What is Python?</label>
            <input type="text" name="q1" required>
        </div>
        <div>
            <label>Question 2: 2 + 2 = ?</label>
            <input type="number" name="q2" required>
        </div>
        <button type="submit" id="submit-btn">Submit Quiz</button>
    </form>
    <p id="status-msg"></p>

    <script src="js/scripts.js"></script>
    <script>
        const params = new URLSearchParams(window.location.search);
        const topic_id = params.get("topic_id");

        // Optionally fetch topic name from backend
        fetchTopics(0).then(topics => {
            const topic = topics.find(t => t.id == topic_id);
            document.getElementById('topic-name').innerText = topic ? topic.name : "Topic";
        });

        document.getElementById("quiz-form").addEventListener("submit", async function(e) {
            e.preventDefault();
            const formData = new FormData(this);
            const answers = {
                q1: formData.get("q1"),
                q2: formData.get("q2")
            };
            const result = await submitQuiz(topic_id, answers);
            document.getElementById("status-msg").innerText = `Quiz Completed! Score: ${result.score}, Status: ${result.data.status}`;
            document.getElementById("submit-btn").disabled = true;
            document.getElementById("submit-btn").innerText = "Completed";
        });
    </script>
</body>
</html>
